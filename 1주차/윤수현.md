# 1. 블로그 서비스 최적화

```
이 챕터에서는 블로그를 제작하면서 최적화를 할 수 있는 방법에 대해 소개하고 있음.
```

- 기본적으로 Lighthouse 검사를 통해 나온 성능을 점진적으로 개선해 나아가는 방식

<br>

---

<br>

## 최적화 기법

### 이미지 사이즈 최적화

- 적절한 이미지 사이즈를 조절하여 성능을 높일 수 있음.

### 코드 분할

- 해당 페이지에서 사용되는 코드와 아닌 코드들을 구분하여 필요한 시점에 로드

### 텍스트 압축

- HTML, CSS, JS 등의 웹 리소스들을 압축하여 적은 사이즈로 다운로드

### 병목 코드 최적화

- 비효율적인 JS 코드들을 수정하여 서비스의 속도를 개선

<br>

---

<br>

## 웹바이탈

### FCP

- First Contentful Paint
- 페이지가 로드될 때 브라우저가 DOM 콘텐츠의 첫 번째 부분을 렌더링 하는 데 걸리는 시간
- Lighthouse 총점의 10%의 가중치

<br>

### SI

- Speed Index
- 콘텐츠가 시각적으로 표시되는 속도
- Lighthouse 총점의 10%의 가중치

<br>

### LCP

- Largest Contentful Paint
- 페이지가 로드될 때 화면 내에 있는 가장 큰 이미지나 텍스트 요소가 렌더링되기까지 걸리는 시간
- Lighthouse 총점의 25%의 가중치

<br>

### TTI

- Time to Interactive
- 사용자가 페이지와 상호 작용이 가능한 시점까지 걸리는 시간
- Lighthouse 총점의 10%의 가중치

<br>

### TBT

- Total Blocking Time
- 페이지가 클릭, 키보드 입력 등의 사용자 입력에 응답하지 않도록 차단된 시간
- Lighthouse 총점의 30%의 가중치

<br>

### CLS

- Cumulative Layout Shift
- 페이지 로드 과정에서 발생하는 예기치 못한 레이아웃 이동을 측정
- Lighthouse 총점의 15%의 가중치

---

<br>

## 이미지 사이즈 최적화

화면에 그려지는 사이즈랑 실제 사이즈 간의 차이를 줄일수록 성능에 좋다.

ex)

`Rendered size` : 120 x 120
`Instrinsic size` : 240 x 240

이것을 적용하려면 이미지의 사이즈를 직접 조정하여 이미지 사이즈를 제어

<br>

---

<br>

## 병목 코드 최적화

비효율적인 자바스크립트 코드를 개선하여 서비스 로직의 시간을 개선한다.

`substring`, `concat` 함수 대신 `replace`를 사용하는 것이 더 효율적

- `substring`: 시작과 선택적 종료 인덱스를 기반으로 문자열 일부를 추출
- `concat`: 여러 문자열을 하나로 합침
- `replace`: 문자열 내의 일부 또는 정규식 패턴과 일치하는 부분을 새로운 값으로 대체

<br>

---

<br>

## 코드 분할 & 지연 로딩

```
- webpack-bundle-analyzer
  => 번들링된 번들 파일이 어떤 코드로 이루어져 있는지 트리맵으로 시각화,
     webpack 설정을 직접 수정해야 한다는 단점이 있음.
- cra 환경에서는 cra-bundle-analyzer 툴 추천
```

페이지에서 필요한 코드만 따로 로드하면 불필요한 코드를 로드하지 않아 속도를 개선할 수 있다는 접근

`지연 로딩` : 코드가 필요한 시점에 로드하여 실행

코드 분할 하기 가장 좋은 방법은 `동적 import` 사용

- 빌드할 떄가 아닌 런타임에 해당 모듈을 로드
- Promise 형태롤 모듈을 반환 => lazy, Suspense 사용

<br>

---

<br>

## 텍스트 압축

- cra 환경의 경우 production 환경과 development 환경에 차이가 있음.
- 최종 서비스의 성능을 측정할 떄는 production 환경으로 빌드된 서비스의 성능을 측정
- production 환경에서 `npm run build` 사용

#### `npm run start` vs `npm run serve` ❓

- npm run serve로 빌드 한 것이 번들 파일의 사이즈가 더 작다.
- 빌드할 때 경량화 같은 최적화가 이루어지기 때문.

텍스트 압축은 파일을 압축하여 전송하고, 사용하는 시점에 해제하는 방식이다.
